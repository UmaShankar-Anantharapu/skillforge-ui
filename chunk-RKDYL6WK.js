import{a}from"./chunk-4P6MEVON.js";import{H as i,K as s,N as o,ec as n}from"./chunk-2627VUCO.js";var p=(()=>{class r{constructor(t,e){this.api=t,this.router=e,this.tokenKey="sf_jwt",this.userKey="sf_user"}signup(t){return this.api.post("/auth/signup",t).pipe(i(e=>{this.setToken(e.token),this.setUser(e.user)}))}login(t){return this.api.post("/auth/login",t).pipe(i(e=>{this.setToken(e.token),this.setUser(e.user)}))}logout(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.userKey),this.router.navigate(["/auth/login"])}getToken(){return localStorage.getItem(this.tokenKey)}isAuthenticated(){return!!this.getToken()}getUser(){let t=localStorage.getItem(this.userKey);if(!t)return null;try{return JSON.parse(t)}catch{return null}}setToken(t){localStorage.setItem(this.tokenKey,t)}setUser(t){localStorage.setItem(this.userKey,JSON.stringify(t))}static{this.\u0275fac=function(e){return new(e||r)(o(a),o(n))}}static{this.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{p as a};
