<div class="skill-assessment-container">
  <div class="assessment-header">
    <h1>Skill Assessment</h1>
    <p>Let's assess your current skill level to create a personalized learning roadmap</p>
  </div>

  <!-- Initial Skill Selection -->
  <div class="skill-selection" *ngIf="!questions.length && !isAnalyzing">
    <form [formGroup]="assessmentForm" (ngSubmit)="analyzeSkill()">
      <div class="form-group">
        <label for="skill">What skill would you like to learn?</label>
        <input 
          type="text" 
          id="skill" 
          formControlName="skill" 
          placeholder="e.g. JavaScript, Machine Learning, Digital Marketing"
          class="form-control"
        >
        <div class="error-message" *ngIf="assessmentForm.get('skill')?.invalid && assessmentForm.get('skill')?.touched">
          Please enter a skill to continue
        </div>
      </div>

      <div class="form-group">
        <label for="currentKnowledge">How would you describe your current knowledge of this skill?</label>
        <select id="currentKnowledge" formControlName="currentKnowledge" class="form-control">
          <option value="">Select your current level</option>
          <option value="none">No prior knowledge</option>
          <option value="basic">Basic understanding</option>
          <option value="intermediate">Intermediate knowledge</option>
          <option value="advanced">Advanced knowledge</option>
        </select>
        <div class="error-message" *ngIf="assessmentForm.get('currentKnowledge')?.invalid && assessmentForm.get('currentKnowledge')?.touched">
          Please select your current knowledge level
        </div>
      </div>

      <div class="action-buttons">
        <button type="submit" class="btn btn-primary" [disabled]="assessmentForm.invalid">Start Assessment</button>
        <button type="button" class="btn btn-secondary" (click)="skipAssessment()">Skip Assessment</button>
      </div>
    </form>
  </div>

  <!-- Loading State -->
  <div class="analyzing-state" *ngIf="isAnalyzing">
    <div class="spinner"></div>
    <p>Analyzing {{ assessmentForm.get('skill')?.value }} to create your personalized assessment...</p>
  </div>

  <!-- Assessment Questions -->
  <div class="assessment-questions" *ngIf="questions.length && !assessmentCompleted">
    <div class="progress-bar">
      <div class="progress" [style.width.%]="(currentQuestionIndex / questions.length) * 100"></div>
    </div>
    
    <div class="question-card">
      <h3>Question {{ currentQuestionIndex + 1 }} of {{ questions.length }}</h3>
      <h2>{{ questions[currentQuestionIndex].question }}</h2>
      
      <div class="options-container">
        <div 
          *ngFor="let option of questions[currentQuestionIndex].options" 
          class="option" 
          [class.selected]="questions[currentQuestionIndex].answer === option.value"
          (click)="answerQuestion(questions[currentQuestionIndex].id, option.value)"
        >
          <span class="option-value">{{ option.value }}</span>
          <span class="option-label">{{ option.label }}</span>
        </div>
      </div>

      <div class="navigation-buttons">
        <button 
          class="btn btn-secondary" 
          [disabled]="currentQuestionIndex === 0"
          (click)="previousQuestion()"
        >
          Previous
        </button>
        <button 
          class="btn btn-primary" 
          [disabled]="questions[currentQuestionIndex].answer === null"
          (click)="currentQuestionIndex === questions.length - 1 ? completeAssessment() : goToNextQuestion()"
        >
          {{ currentQuestionIndex === questions.length - 1 ? 'Complete Assessment' : 'Next' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Assessment Results -->
  <div class="assessment-results" *ngIf="assessmentCompleted">
    <div class="results-header">
      <h2>Assessment Complete!</h2>
      <p>Based on your answers, we've determined your skill level:</p>
    </div>

    <div class="skill-level-card">
      <div class="skill-level">
        <h3>{{ assessmentForm.get('skill')?.value }}</h3>
        <div class="level-badge" [ngClass]="skillLevel">
          {{ skillLevel | titlecase }}
        </div>
        <div class="score">Score: {{ assessmentScore }} / 5</div>
      </div>

      <div class="recommendations">
        <h4>Recommendations:</h4>
        <ul>
          <li *ngFor="let recommendation of recommendations">{{ recommendation }}</li>
        </ul>
      </div>
    </div>

    <div class="action-buttons">
      <button class="btn btn-primary" (click)="saveAndContinue()">Continue to Learning Goals</button>
    </div>
  </div>
</div>