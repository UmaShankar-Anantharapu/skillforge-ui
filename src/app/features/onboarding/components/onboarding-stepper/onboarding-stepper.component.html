<div class="onboarding-stepper-container">
  <div class="onboarding-card">
    
    <!-- Get Started View (Initial State) -->
    <div *ngIf="currentStep === 0" class="get-started-view fade-in">
      <!-- Hero Section -->
      <div class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title main-title">
            <span class="gradient-text">Personalised Learning Experience</span>
          </h1>
          
          <p class="hero-description">
            We'll guide you through a personalized setup to create your perfect learning experience.
            Get recommendations tailored just for you.
          </p>
          
          <div class="hero-stats">
            <div class="stat-item">
              <div class="stat-number">5-10</div>
              <div class="stat-label">Minutes</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
              <div class="stat-number">9</div>
              <div class="stat-label">Steps</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
              <div class="stat-number">100%</div>
              <div class="stat-label">Personalized</div>
            </div>
          </div>
        </div>
        
        <div class="hero-illustration">
          <div class="floating-cards">
            <div class="card-item card-1">
              <mat-icon>person</mat-icon>
              <span>Profile</span>
            </div>
            <div class="card-item card-2">
              <mat-icon>school</mat-icon>
              <span>Skills</span>
            </div>
            <div class="card-item card-3">
              <mat-icon>schedule</mat-icon>
              <span>Schedule</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Steps Preview -->
      <div class="steps-preview-section">
        <h3 class="preview-title">What We'll Cover</h3>
        <div class="steps-grid">
          <div class="step-preview-card" *ngFor="let title of stepTitles.slice(1); let i = index" 
               [style.animation-delay.ms]="i * 100">
            <div class="step-preview-icon">
              <div class="step-number">{{ i + 1 }}</div>
              <div class="step-progress-ring">
                <svg class="progress-ring" width="60" height="60">
                  <circle class="progress-ring-circle" cx="30" cy="30" r="25"></circle>
                </svg>
              </div>
            </div>
            <div class="step-preview-content">
              <h4 class="step-title">{{ title }}</h4>
              <p class="step-description">{{ getStepDescription(i + 1) }}</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- CTA Section -->
      <div class="cta-section">
        <div class="cta-buttons">
          <button class="get-started-button" (click)="startOnboarding()">
            <mat-icon>rocket_launch</mat-icon>
            <span>Start My Journey</span>
            <div class="button-glow"></div>
          </button>
          
          <button class="skip-button" (click)="closeOnboarding()">
            <span>Skip for now</span>
          </button>
        </div>
        
        <div class="privacy-footer">
          <mat-icon>shield</mat-icon>
          <span>Your data is secure and will only be used to personalize your experience</span>
        </div>
      </div>
    </div>
    
    <!-- Two-panel layout (after Get Started) -->
    <div *ngIf="currentStep > 0" class="onboarding-panels">
      <!-- Left panel (stepper) -->
      <div class="left-panel">
        <!-- Progress Header -->
        <div class="progress-header">
          <div class="progress-info">
            <h3 class="progress-title">Your Journey</h3>
            <div class="progress-stats">
              <span class="current-step">Step {{ currentStep }}</span>
              <span class="total-steps">of {{ stepTitles.length - 1 }}</span>
            </div>
          </div>
          <div class="progress-circle">
            <svg class="progress-ring" width="60" height="60">
              <circle class="progress-ring-bg" cx="30" cy="30" r="25" fill="none" stroke="rgba(var(--primary-rgb), 0.1)" stroke-width="4"></circle>
              <circle class="progress-ring-fill" cx="30" cy="30" r="25" fill="none" stroke="var(--primary-color)" stroke-width="4" 
                      [style.stroke-dasharray]="157" 
                      [style.stroke-dashoffset]="157 - (157 * currentStep / (stepTitles.length - 1))"
                      transform="rotate(-90 30 30)"></circle>
            </svg>
            <div class="progress-percentage">{{ Math.round((currentStep / (stepTitles.length - 1)) * 100) }}%</div>
          </div>
        </div>

        <!-- Stepper Navigation -->
        <div class="stepper-nav">
          <div *ngFor="let title of stepTitles.slice(1); let i = index" 
               class="step-item" 
               [class.active]="currentStep === i + 1"
               [class.completed]="i + 1 < currentStep"
               [class.upcoming]="i + 1 > currentStep"
               (click)="goToStep(i + 1)">
            
            <!-- Step Connection Line -->
            <div class="step-connector" *ngIf="i > 0" 
                 [class.completed]="i < currentStep">
            </div>
            
            <!-- Step Icon/Number -->
            <div class="step-icon">
              <div class="step-number" *ngIf="i + 1 > currentStep">{{ i + 1 }}</div>
              <mat-icon *ngIf="i + 1 < currentStep" class="completed-icon">check_circle</mat-icon>
              <div class="step-number active" *ngIf="i + 1 === currentStep">
                <div class="pulse-ring"></div>
                {{ i + 1 }}
              </div>
            </div>
            
            <!-- Step Content -->
            <div class="step-content">
              <div class="step-title">{{ title }}</div>
              <div class="step-description">{{ getStepDescription(i + 1) }}</div>
              <div class="step-status">
                <span *ngIf="i + 1 < currentStep" class="status-completed">
                  <mat-icon>check</mat-icon>
                  Completed
                </span>
                <span *ngIf="i + 1 === currentStep" class="status-current">
                  <mat-icon>radio_button_checked</mat-icon>
                  Current
                </span>
                <span *ngIf="i + 1 > currentStep" class="status-upcoming">
                  <mat-icon>radio_button_unchecked</mat-icon>
                  Upcoming
                </span>
              </div>
            </div>
            
            <!-- Step Actions -->
            <div class="step-actions-mini" *ngIf="i + 1 === currentStep">
              <button mat-icon-button class="edit-step" (click)="$event.stopPropagation()">
                <mat-icon>edit</mat-icon>
              </button>
            </div>
          </div>
        </div>

        <!-- Navigation Footer -->
        <div class="nav-footer">
          <div class="estimated-time">
            <mat-icon>schedule</mat-icon>
            <span>~{{ getEstimatedTime() }} min remaining</span>
          </div>
          <div class="help-section">
            <button mat-button class="help-button" (click)="showHelp()">
              <mat-icon>help_outline</mat-icon>
              Need Help?
            </button>
          </div>
        </div>
      </div>
      
      <!-- Right panel (content) -->
      <div class="right-panel">
        <div class="right-panel-content">
        
        <!-- Step 1: Welcome & Basic Profile -->
        <div *ngIf="currentStep === 1" class="step-container" [@stepTransition]>
          <div class="step-header">
            <h2>Let's Get Started</h2>
            <p class="step-description">Tell us about yourself to personalize your learning experience</p>
          </div>
          
          <form [formGroup]="basicProfileForm" class="form-cards">
            <!-- Personal Information Card -->
            <div class="form-card">
              <div class="card-header">
                <mat-icon class="card-icon">person</mat-icon>
                <div class="card-title">
                  <h3>Personal Information</h3>
                  <p>Basic details to get you started</p>
                </div>
              </div>
              
              <div class="card-content">
                <div class="form-row">
                  <div class="input-group form-field">
                    <input required="" type="text" formControlName="fullName" autocomplete="off" class="input">
                    <label class="user-label">Full Name</label>
                    <mat-error *ngIf="basicProfileForm.get('fullName')?.hasError('required')">Full name is required</mat-error>
                  </div>
                  
                  <div class="input-group form-field">
                    <input required="" type="email" formControlName="email" autocomplete="off" class="input">
                    <label class="user-label">Email Address</label>
                    <mat-error *ngIf="basicProfileForm.get('email')?.hasError('required')">Email is required</mat-error>
                    <mat-error *ngIf="basicProfileForm.get('email')?.hasError('email')">Please enter a valid email address</mat-error>
                  </div>
                </div>
                
                <div class="form-row">
                  <div class="input-group form-field">
                    <input type="tel" formControlName="phoneNumber" autocomplete="off" class="input">
                    <label class="user-label">Phone Number</label>
                  </div>
                  
                  <mat-form-field appearance="outline" class="form-field">
                    <mat-label>Preferred Language</mat-label>
                    <mat-select formControlName="preferredLanguage" required>
                      <mat-option value="English">English</mat-option>
                      <mat-option value="Spanish">Spanish</mat-option>
                      <mat-option value="French">French</mat-option>
                      <mat-option value="German">German</mat-option>
                      <mat-option value="Chinese">Chinese</mat-option>
                      <mat-option value="Japanese">Japanese</mat-option>
                      <mat-option value="Other">Other</mat-option>
                    </mat-select>
                    <mat-icon matSuffix>language</mat-icon>
                    <mat-error *ngIf="basicProfileForm.get('preferredLanguage')?.hasError('required')">Preferred language is required</mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
            
            <!-- Professional Background Card -->
            <div class="form-card">
              <div class="card-header">
                <mat-icon class="card-icon">work</mat-icon>
                <div class="card-title">
                  <h3>Professional Background</h3>
                  <p>Help us understand your career context</p>
                </div>
              </div>
              
              <div class="card-content">
                <div class="form-row">
                  <div class="input-group form-field">
                    <input required="" type="text" formControlName="jobTitle" autocomplete="off" class="input">
                    <label class="user-label">Current Job Title</label>
                    <mat-error *ngIf="basicProfileForm.get('jobTitle')?.hasError('required')">Job title is required</mat-error>
                  </div>
                  
                  <div class="input-group form-field">
                    <input type="text" formControlName="company" autocomplete="off" class="input">
                    <label class="user-label">Company Name</label>
                  </div>
                </div>
                
                <div class="form-row">
                  <mat-form-field appearance="outline" class="form-field">
                    <mat-label>Industry/Sector</mat-label>
                    <mat-select formControlName="industry" required>
                      <mat-option *ngFor="let industry of industries" [value]="industry">{{ industry }}</mat-option>
                    </mat-select>
                    <mat-icon matSuffix>domain</mat-icon>
                    <mat-error *ngIf="basicProfileForm.get('industry')?.hasError('required')">Industry is required</mat-error>
                  </mat-form-field>
                  
                  <mat-form-field appearance="outline" class="form-field">
                    <mat-label>Years of Professional Experience</mat-label>
                    <mat-select formControlName="yearsExperience" required>
                      <mat-option value="0-2">0-2 years</mat-option>
                      <mat-option value="3-5">3-5 years</mat-option>
                      <mat-option value="6-10">6-10 years</mat-option>
                      <mat-option value="10+">10+ years</mat-option>
                    </mat-select>
                    <mat-icon matSuffix>timeline</mat-icon>
                    <mat-error *ngIf="basicProfileForm.get('yearsExperience')?.hasError('required')">Years of experience is required</mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
            
          </form>
        </div>
      
   <!-- Step 2: Learning Goals & Context -->
   <div *ngIf="currentStep === 2" class="step-container" [@stepTransition]>
     <div class="step-header">
       <h2>What Brings You Here?</h2>
       <p class="step-description">Help us understand your learning objectives and motivation</p>
     </div>
     
     <form [formGroup]="learningGoalsForm" class="form-cards">
       <!-- Learning Objectives Card -->
       <div class="form-card">
         <div class="card-header">
           <mat-icon class="card-icon">flag</mat-icon>
           <div class="card-title">
             <h3>Learning Objectives</h3>
             <p>Define your primary goals and aspirations</p>
           </div>
         </div>
         
         <div class="card-content">
           <div class="form-row">
             <mat-form-field appearance="outline" class="form-field">
               <mat-label>Primary Learning Goal</mat-label>
               <mat-select formControlName="primaryLearningGoal" required>
                 <mat-option value="Career advancement">Career advancement</mat-option>
                 <mat-option value="Skill enhancement">Skill enhancement</mat-option>
                 <mat-option value="Career change">Career change</mat-option>
                 <mat-option value="Interview prep">Interview prep</mat-option>
                 <mat-option value="Personal interest">Personal interest</mat-option>
               </mat-select>
               <mat-icon matSuffix>target</mat-icon>
               <mat-error *ngIf="learningGoalsForm.get('primaryLearningGoal')?.hasError('required')">Primary goal is required</mat-error>
             </mat-form-field>
             
             <mat-form-field appearance="outline" class="form-field">
               <mat-label>Specific Target Role (optional)</mat-label>
               <input matInput formControlName="targetRole" placeholder="E.g., Senior Developer, Data Scientist">
               <mat-icon matSuffix>work_outline</mat-icon>
             </mat-form-field>
           </div>
         </div>
       </div>
       
       <!-- Timeline & Commitment Card -->
       <div class="form-card">
         <div class="card-header">
           <mat-icon class="card-icon">schedule</mat-icon>
           <div class="card-title">
             <h3>Timeline & Commitment</h3>
             <p>Set your learning pace and dedication level</p>
           </div>
         </div>
         
         <div class="card-content">
           <div class="form-row">
             <mat-form-field appearance="outline" class="form-field">
               <mat-label>Timeline/Deadline</mat-label>
               <mat-select formControlName="timeline" required>
                 <mat-option value="1 month">1 month</mat-option>
                 <mat-option value="3 months">3 months</mat-option>
                 <mat-option value="6 months">6 months</mat-option>
                 <mat-option value="1 year">1 year</mat-option>
                 <mat-option value="No deadline">No deadline</mat-option>
               </mat-select>
               <mat-icon matSuffix>event</mat-icon>
               <mat-error *ngIf="learningGoalsForm.get('timeline')?.hasError('required')">Timeline is required</mat-error>
             </mat-form-field>
             
             <mat-form-field appearance="outline" class="form-field">
               <mat-label>Motivation Level</mat-label>
               <mat-select formControlName="motivationLevel" required>
                 <mat-option value="Casual learner">Casual learner</mat-option>
                 <mat-option value="Moderate commitment">Moderate commitment</mat-option>
                 <mat-option value="Highly motivated">Highly motivated</mat-option>
                 <mat-option value="Career critical">Career critical</mat-option>
               </mat-select>
               <mat-icon matSuffix>trending_up</mat-icon>
               <mat-error *ngIf="learningGoalsForm.get('motivationLevel')?.hasError('required')">Motivation level is required</mat-error>
             </mat-form-field>
           </div>
         </div>
       </div>
       
       <!-- Current Challenges Card -->
       <div class="form-card">
         <div class="card-header">
           <mat-icon class="card-icon">help_outline</mat-icon>
           <div class="card-title">
             <h3>Current Challenges</h3>
             <p>What's holding you back from learning?</p>
           </div>
         </div>
         
         <div class="card-content">
           <div class="form-row">
             <mat-form-field appearance="outline" class="form-field full-width-field">
               <mat-label>Current Challenge</mat-label>
               <mat-select formControlName="currentChallenge" required>
                 <mat-option value="Lack of time">Lack of time</mat-option>
                 <mat-option value="Don't know where to start">Don't know where to start</mat-option>
                 <mat-option value="Need structured learning">Need structured learning</mat-option>
                 <mat-option value="Want to stay updated">Want to stay updated</mat-option>
               </mat-select>
               <mat-icon matSuffix>psychology</mat-icon>
               <mat-error *ngIf="learningGoalsForm.get('currentChallenge')?.hasError('required')">Current challenge is required</mat-error>
             </mat-form-field>
           </div>
         </div>
       </div>
       
     </form>
   </div>
   
   <!-- Step 3: Learning Preferences -->
   <div *ngIf="currentStep === 3" class="step-container" [@stepTransition]>
     <form [formGroup]="learningPreferencesForm">
       <h2>How Do You Learn Best?</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Learning Style</mat-label>
           <mat-select formControlName="learningStyle" required>
             <mat-option value="Visual">Visual</mat-option>
             <mat-option value="Auditory">Auditory</mat-option>
             <mat-option value="Hands-on/Kinesthetic">Hands-on/Kinesthetic</mat-option>
             <mat-option value="Reading/Text">Reading/Text</mat-option>
           </mat-select>
           <mat-error *ngIf="learningPreferencesForm.get('learningStyle')?.hasError('required')">Learning style is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Preferred Content Format</mat-label>
           <mat-select formControlName="contentFormat" required>
             <mat-option value="Video tutorials">Video tutorials</mat-option>
             <mat-option value="Interactive exercises">Interactive exercises</mat-option>
             <mat-option value="Text articles">Text articles</mat-option>
             <mat-option value="Combination">Combination</mat-option>
           </mat-select>
           <mat-error *ngIf="learningPreferencesForm.get('contentFormat')?.hasError('required')">Content format is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Session Duration Preference</mat-label>
           <mat-select formControlName="sessionDuration" required>
             <mat-option value="5-15 min">5-15 minutes</mat-option>
             <mat-option value="15-30 min">15-30 minutes</mat-option>
             <mat-option value="30-60 min">30-60 minutes</mat-option>
             <mat-option value="60+ min">60+ minutes</mat-option>
           </mat-select>
           <mat-error *ngIf="learningPreferencesForm.get('sessionDuration')?.hasError('required')">Session duration is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Learning Difficulty Preference</mat-label>
           <mat-select formControlName="difficultyPreference" required>
             <mat-option value="Gradual progression">Gradual progression</mat-option>
             <mat-option value="Moderate pace">Moderate pace</mat-option>
             <mat-option value="Fast-track/Intensive">Fast-track/Intensive</mat-option>
           </mat-select>
           <mat-error *ngIf="learningPreferencesForm.get('difficultyPreference')?.hasError('required')">Difficulty preference is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Device You'll Use Most</mat-label>
           <mat-select formControlName="devicePreference" required>
             <mat-option value="Mobile">Mobile</mat-option>
             <mat-option value="Desktop">Desktop</mat-option>
             <mat-option value="Tablet">Tablet</mat-option>
             <mat-option value="All equally">All equally</mat-option>
           </mat-select>
           <mat-error *ngIf="learningPreferencesForm.get('devicePreference')?.hasError('required')">Device preference is required</mat-error>
         </mat-form-field>
       </div>
       
     </form>
   </div>
   
   <!-- Step 4: Schedule & Availability -->
   <div *ngIf="currentStep === 4" class="step-container" [@stepTransition]>
     <form [formGroup]="scheduleForm">
       <h2>When Can You Learn?</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Available Time Per Day</mat-label>
           <mat-select formControlName="availableTimePerDay" required>
             <mat-option value="15-30 min">15-30 minutes</mat-option>
             <mat-option value="30-60 min">30-60 minutes</mat-option>
             <mat-option value="1-2 hours">1-2 hours</mat-option>
             <mat-option value="2+ hours">2+ hours</mat-option>
           </mat-select>
           <mat-error *ngIf="scheduleForm.get('availableTimePerDay')?.hasError('required')">Available time is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Best Learning Times</mat-label>
           <mat-select formControlName="bestLearningTimes" multiple required>
             <mat-option value="Morning">Morning</mat-option>
             <mat-option value="Afternoon">Afternoon</mat-option>
             <mat-option value="Evening">Evening</mat-option>
             <mat-option value="Late night">Late night</mat-option>
           </mat-select>
           <mat-error *ngIf="scheduleForm.get('bestLearningTimes')?.hasError('required')">Best learning times are required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Days Per Week</mat-label>
           <mat-select formControlName="daysPerWeek" required>
             <mat-option value="1-2 days">1-2 days</mat-option>
             <mat-option value="3-4 days">3-4 days</mat-option>
             <mat-option value="5-6 days">5-6 days</mat-option>
             <mat-option value="Daily">Daily</mat-option>
           </mat-select>
           <mat-error *ngIf="scheduleForm.get('daysPerWeek')?.hasError('required')">Days per week is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Time Zone</mat-label>
           <input matInput formControlName="timeZone" placeholder="Auto-detected time zone" required>
           <mat-error *ngIf="scheduleForm.get('timeZone')?.hasError('required')">Time zone is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Preferred Reminder Method</mat-label>
           <mat-select formControlName="reminderMethod" required>
             <mat-option value="Email">Email</mat-option>
             <mat-option value="Push notification">Push notification</mat-option>
             <mat-option value="SMS">SMS</mat-option>
             <mat-option value="None">None</mat-option>
           </mat-select>
           <mat-error *ngIf="scheduleForm.get('reminderMethod')?.hasError('required')">Reminder method is required</mat-error>
         </mat-form-field>
       </div>
       
     </form>
   </div>
   
   <!-- Step 5: Skills Assessment Setup -->
   <div *ngIf="currentStep === 5" class="step-container" [@stepTransition]>
     <form [formGroup]="skillsSetupForm">
       <h2>What Skills Matter to You?</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Primary Skill Category</mat-label>
           <mat-select formControlName="primarySkillCategory" required>
             <mat-option value="Technology">Technology</mat-option>
             <mat-option value="Business">Business</mat-option>
             <mat-option value="Design">Design</mat-option>
             <mat-option value="Marketing">Marketing</mat-option>
             <mat-option value="Leadership">Leadership</mat-option>
             <mat-option value="Other">Other</mat-option>
           </mat-select>
           <mat-error *ngIf="skillsSetupForm.get('primarySkillCategory')?.hasError('required')">Primary skill category is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Specific Skills to Learn</mat-label>
           <mat-chip-grid #chipGrid>
             <mat-chip-row *ngFor="let skill of selectedSkills" (removed)="removeSkill(skill)">
               {{skill}}
               <button matChipRemove>
                 <mat-icon>cancel</mat-icon>
               </button>
             </mat-chip-row>
             <input placeholder="Search skills..."
                    [matChipInputFor]="chipGrid"
                    [formControl]="skillCtrl"
                    [matAutocomplete]="auto">
           </mat-chip-grid>
           <mat-autocomplete #auto="matAutocomplete" (optionSelected)="addSkill($event)">
             <mat-option *ngFor="let skill of filteredSkills | async" [value]="skill">
               {{skill}}
             </mat-option>
           </mat-autocomplete>
           <mat-error *ngIf="skillsSetupForm.get('specificSkills')?.hasError('required')">Please select at least one skill</mat-error>
         </mat-form-field>
         
         <div *ngFor="let skill of selectedSkills; let i = index" class="skill-level-container">
           <h4>{{ skill }}</h4>
           <mat-form-field appearance="outline" class="full-width">
             <mat-label>Current Skill Level</mat-label>
             <mat-select [formControlName]="'skillLevel_' + i" required>
               <mat-option value="Beginner">Beginner</mat-option>
               <mat-option value="Intermediate">Intermediate</mat-option>
               <mat-option value="Advanced">Advanced</mat-option>
               <mat-option value="Expert">Expert</mat-option>
             </mat-select>
           </mat-form-field>
         </div>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Related Skills You Have (optional)</mat-label>
           <mat-chip-grid #relatedChipGrid>
             <mat-chip-row *ngFor="let skill of relatedSkills" (removed)="removeRelatedSkill(skill)">
               {{skill}}
               <button matChipRemove>
                 <mat-icon>cancel</mat-icon>
               </button>
             </mat-chip-row>
             <input placeholder="Add related skills..."
                    [matChipInputFor]="relatedChipGrid"
                    [formControl]="relatedSkillCtrl"
                    [matAutocomplete]="relatedAuto">
           </mat-chip-grid>
           <mat-autocomplete #relatedAuto="matAutocomplete" (optionSelected)="addRelatedSkill($event)">
             <mat-option *ngFor="let skill of filteredRelatedSkills | async" [value]="skill">
               {{skill}}
             </mat-option>
           </mat-autocomplete>
         </mat-form-field>
         
         <div class="priority-ranking" *ngIf="selectedSkills.length > 0">
           <h4>Priority Ranking (Drag to reorder)</h4>
           <div cdkDropList class="priority-list" (cdkDropListDropped)="drop($event)">
             <div class="priority-box" *ngFor="let skill of prioritySkills" cdkDrag>
               <div class="priority-handle" cdkDragHandle>
                 <mat-icon>drag_indicator</mat-icon>
               </div>
               <div>{{ skill }}</div>
             </div>
           </div>
         </div>
       </div>
       
     </form>
   </div>
   
   <!-- Step 6: Background & Experience -->
   <div *ngIf="currentStep === 6" class="step-container" [@stepTransition]>
     <form [formGroup]="backgroundForm">
       <h2>Your Professional Background</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Education Level</mat-label>
           <mat-select formControlName="educationLevel" required>
             <mat-option value="High School">High School</mat-option>
             <mat-option value="Bachelor's">Bachelor's</mat-option>
             <mat-option value="Master's">Master's</mat-option>
             <mat-option value="PhD">PhD</mat-option>
             <mat-option value="Professional Certification">Professional Certification</mat-option>
             <mat-option value="Self-taught">Self-taught</mat-option>
           </mat-select>
           <mat-error *ngIf="backgroundForm.get('educationLevel')?.hasError('required')">Education level is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Relevant Certifications (optional)</mat-label>
           <mat-chip-grid #certChipGrid>
             <mat-chip-row *ngFor="let cert of certifications" (removed)="removeCertification(cert)">
               {{cert}}
               <button matChipRemove>
                 <mat-icon>cancel</mat-icon>
               </button>
             </mat-chip-row>
             <input placeholder="Add certifications..."
                    [matChipInputFor]="certChipGrid"
                    [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                    (matChipInputTokenEnd)="addCertification($event)">
           </mat-chip-grid>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Previous Learning Experience</mat-label>
           <mat-select formControlName="previousLearningExperience" required>
             <mat-option value="Online courses">Online courses</mat-option>
             <mat-option value="Bootcamps">Bootcamps</mat-option>
             <mat-option value="University">University</mat-option>
             <mat-option value="Self-study">Self-study</mat-option>
             <mat-option value="None">None</mat-option>
           </mat-select>
           <mat-error *ngIf="backgroundForm.get('previousLearningExperience')?.hasError('required')">Previous learning experience is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Team Role</mat-label>
           <mat-select formControlName="teamRole" required>
             <mat-option value="Individual contributor">Individual contributor</mat-option>
             <mat-option value="Team lead">Team lead</mat-option>
             <mat-option value="Manager">Manager</mat-option>
             <mat-option value="Senior manager">Senior manager</mat-option>
             <mat-option value="Executive">Executive</mat-option>
             <mat-option value="Student">Student</mat-option>
           </mat-select>
           <mat-error *ngIf="backgroundForm.get('teamRole')?.hasError('required')">Team role is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Learning Budget</mat-label>
           <mat-select formControlName="learningBudget" required>
             <mat-option value="Free only">Free only</mat-option>
             <mat-option value="<$50/month"><$50/month</mat-option>
             <mat-option value="$50-200/month">$50-200/month</mat-option>
             <mat-option value="$200+/month">$200+/month</mat-option>
             <mat-option value="Company sponsored">Company sponsored</mat-option>
           </mat-select>
           <mat-error *ngIf="backgroundForm.get('learningBudget')?.hasError('required')">Learning budget is required</mat-error>
         </mat-form-field>
       </div>
       
     </form>
   </div>
   
   <!-- Step 7: Success Metrics & Preferences -->
   <div *ngIf="currentStep === 7" class="step-container" [@stepTransition]>
     <form [formGroup]="successMetricsForm">
       <h2>How Will You Measure Success?</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Success Measurement</mat-label>
           <mat-select formControlName="successMeasurement" required>
             <mat-option value="Completion certificates">Completion certificates</mat-option>
             <mat-option value="Skill assessments">Skill assessments</mat-option>
             <mat-option value="Real projects">Real projects</mat-option>
             <mat-option value="Portfolio building">Portfolio building</mat-option>
             <mat-option value="Job placement">Job placement</mat-option>
           </mat-select>
           <mat-error *ngIf="successMetricsForm.get('successMeasurement')?.hasError('required')">Success measurement is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Progress Tracking Preference</mat-label>
           <mat-select formControlName="progressTrackingPreference" required>
             <mat-option value="Detailed analytics">Detailed analytics</mat-option>
             <mat-option value="Simple progress bar">Simple progress bar</mat-option>
             <mat-option value="Milestone-based">Milestone-based</mat-option>
             <mat-option value="Minimal tracking">Minimal tracking</mat-option>
           </mat-select>
           <mat-error *ngIf="successMetricsForm.get('progressTrackingPreference')?.hasError('required')">Progress tracking preference is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Community Participation</mat-label>
           <mat-select formControlName="communityParticipation" required>
             <mat-option value="Very active">Very active</mat-option>
             <mat-option value="Moderate participation">Moderate participation</mat-option>
             <mat-option value="Occasional">Occasional</mat-option>
             <mat-option value="Prefer solo learning">Prefer solo learning</mat-option>
           </mat-select>
           <mat-error *ngIf="successMetricsForm.get('communityParticipation')?.hasError('required')">Community participation preference is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Accessibility Requirements (optional)</mat-label>
           <mat-select formControlName="accessibilityRequirements" multiple>
             <mat-option value="Screen reader">Screen reader</mat-option>
             <mat-option value="Large text">Large text</mat-option>
             <mat-option value="High contrast">High contrast</mat-option>
             <mat-option value="Keyboard navigation">Keyboard navigation</mat-option>
             <mat-option value="None">None</mat-option>
           </mat-select>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Communication Preferences</mat-label>
           <mat-select formControlName="communicationPreferences" required>
             <mat-option value="Email updates">Email updates</mat-option>
             <mat-option value="In-app notifications">In-app notifications</mat-option>
             <mat-option value="SMS reminders">SMS reminders</mat-option>
             <mat-option value="Weekly digests">Weekly digests</mat-option>
           </mat-select>
           <mat-error *ngIf="successMetricsForm.get('communicationPreferences')?.hasError('required')">Communication preference is required</mat-error>
         </mat-form-field>
       </div>
       
     </form>
   </div>
   <!-- Step 8: Skill Assessment -->
   <div *ngIf="currentStep === 8" class="step-container" [@stepTransition]>
     <form [formGroup]="skillAssessmentForm">
       <h2>Quick Skill Check - Let's See Where You Stand</h2>
       <p class="step-description">This optional assessment helps us tailor content to your current skill level.</p>
       
       <div class="form-fields">
         <div *ngFor="let skill of prioritySkills.slice(0, 3); let i = index" class="skill-assessment-container">
           <h3>{{ skill }}</h3>
           
           <mat-form-field appearance="outline" class="full-width">
             <mat-label>Confidence Level (1-10)</mat-label>
             <input matInput type="number" [formControlName]="'confidenceLevel_' + i" min="1" max="10" required>
             <mat-error *ngIf="skillAssessmentForm.get('confidenceLevel_' + i)?.hasError('required')">Confidence level is required</mat-error>
             <mat-error *ngIf="skillAssessmentForm.get('confidenceLevel_' + i)?.hasError('min') || skillAssessmentForm.get('confidenceLevel_' + i)?.hasError('max')">Value must be between 1 and 10</mat-error>
           </mat-form-field>
           
           <mat-form-field appearance="outline" class="full-width">
             <mat-label>Recent Experience</mat-label>
             <mat-select [formControlName]="'recentExperience_' + i" required>
               <mat-option value="Currently using">Currently using</mat-option>
               <mat-option value="Within 6 months">Within 6 months</mat-option>
               <mat-option value="6-12 months ago">6-12 months ago</mat-option>
               <mat-option value="1+ years ago">1+ years ago</mat-option>
               <mat-option value="Never used professionally">Never used professionally</mat-option>
             </mat-select>
             <mat-error *ngIf="skillAssessmentForm.get('recentExperience_' + i)?.hasError('required')">Recent experience is required</mat-error>
           </mat-form-field>
           
           <mat-form-field appearance="outline" class="full-width">
             <mat-label>Learning Goal for This Skill</mat-label>
             <mat-select [formControlName]="'learningGoal_' + i" required>
               <mat-option value="Learn basics">Learn basics</mat-option>
               <mat-option value="Improve proficiency">Improve proficiency</mat-option>
               <mat-option value="Master advanced concepts">Master advanced concepts</mat-option>
               <mat-option value="Stay updated with trends">Stay updated with trends</mat-option>
             </mat-select>
             <mat-error *ngIf="skillAssessmentForm.get('learningGoal_' + i)?.hasError('required')">Learning goal is required</mat-error>
           </mat-form-field>
           
           <mat-divider *ngIf="i < prioritySkills.slice(0, 3).length - 1" class="skill-divider"></mat-divider>
         </div>
         
         <div *ngIf="prioritySkills.length === 0" class="no-skills-message">
           <p>Please select and prioritize skills in the previous step to complete this assessment.</p>
         </div>
       </div>
       
     </form>
   </div>
   
   <!-- Step 9: Final Setup & Preferences -->
   <div *ngIf="currentStep === 9" class="step-container" [@stepTransition]>
     <form [formGroup]="finalSetupForm">
       <h2>Almost Done - Final Touches</h2>
       
       <div class="form-fields">
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Profile Privacy</mat-label>
           <mat-select formControlName="profilePrivacy" required>
             <mat-option value="Public profile">Public profile</mat-option>
             <mat-option value="Private">Private</mat-option>
             <mat-option value="Visible to connections only">Visible to connections only</mat-option>
           </mat-select>
           <mat-error *ngIf="finalSetupForm.get('profilePrivacy')?.hasError('required')">Profile privacy setting is required</mat-error>
         </mat-form-field>
         
         <div class="consent-section">
           <h3>Data Sharing Consent</h3>
           <div class="consent-checkboxes">
             <mat-checkbox formControlName="analyticsConsent" required>Allow analytics to improve your experience</mat-checkbox>
             <mat-checkbox formControlName="marketingConsent">Receive marketing communications</mat-checkbox>
             <mat-checkbox formControlName="thirdPartyConsent">Allow integration with third-party services</mat-checkbox>
           </div>
           <mat-error *ngIf="finalSetupForm.get('analyticsConsent')?.hasError('required')">Analytics consent is required</mat-error>
         </div>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Notification Preferences</mat-label>
           <mat-select formControlName="notificationPreferences" multiple required>
             <mat-option value="Course updates">Course updates</mat-option>
             <mat-option value="Learning reminders">Learning reminders</mat-option>
             <mat-option value="Community activity">Community activity</mat-option>
             <mat-option value="New content alerts">New content alerts</mat-option>
           </mat-select>
           <mat-error *ngIf="finalSetupForm.get('notificationPreferences')?.hasError('required')">At least one notification preference is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Theme Preference</mat-label>
           <mat-select formControlName="themePreference" required>
             <mat-option value="Dark mode">Dark mode</mat-option>
             <mat-option value="Light mode">Light mode</mat-option>
             <mat-option value="Auto">Auto (follow system)</mat-option>
           </mat-select>
           <mat-error *ngIf="finalSetupForm.get('themePreference')?.hasError('required')">Theme preference is required</mat-error>
         </mat-form-field>
         
         <mat-form-field appearance="outline" class="full-width">
           <mat-label>Beta Features</mat-label>
           <mat-select formControlName="betaFeatures" required>
             <mat-option value="Yes">Yes, I'm interested in trying new features early</mat-option>
             <mat-option value="No">No, I prefer stable features only</mat-option>
           </mat-select>
           <mat-error *ngIf="finalSetupForm.get('betaFeatures')?.hasError('required')">Beta features preference is required</mat-error>
         </mat-form-field>
       </div>
       
     </form>
   </div>
   </div>
   
   <!-- Fixed Footer with Step Actions -->
   <div class="step-actions-footer">
     <div class="step-actions" [class.single-button]="currentStep <= 1">
       <button mat-button class="back-button" (click)="previousStep()" *ngIf="currentStep > 1">
         <mat-icon>arrow_back</mat-icon>
         Back
       </button>
       <button mat-raised-button color="primary" class="continue-button" 
               (click)="currentStep === 9 ? completeOnboarding() : nextStep()" 
               [disabled]="isStepInvalid()">
         <span *ngIf="currentStep < 9">Continue</span>
         <span *ngIf="currentStep === 9">Complete Onboarding</span>
         <mat-icon *ngIf="currentStep < 9">arrow_forward</mat-icon>
         <mat-icon *ngIf="currentStep === 9">check</mat-icon>
       </button>
     </div>
   </div>
   </div>
 </div>
</div>