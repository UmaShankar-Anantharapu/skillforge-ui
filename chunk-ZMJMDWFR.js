import{a as O}from"./chunk-USY43AOF.js";import{a as F}from"./chunk-IRV7PH2R.js";import{Da as d,Ea as k,K as P,Kb as E,L as w,Lb as M,Ma as a,N as y,Na as o,Oa as S,R as j,S as I,Sa as C,Ub as V,Va as m,W as p,X as g,Xa as s,a as f,b as _,fb as l,gb as u,hb as b,hc as T,ma as r,na as x,za as v}from"./chunk-2627VUCO.js";var N=(()=>{class i{constructor(e){this.api=e}list(){return this.api.get("/challenge")}join(e){return this.api.post("/challenge/join",{id:e})}updateProgress(e,t){return this.api.post("/challenges/progress",{id:e,progress:t})}static{this.\u0275fac=function(t){return new(t||i)(y(F))}}static{this.\u0275prov=P({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function A(i,h){if(i&1){let e=C();a(0,"div",7)(1,"div",8),S(2,"div",9),o(),a(3,"p"),l(4),o(),a(5,"div",10)(6,"button",11),m("click",function(){p(e);let n=s().$implicit,c=s();return g(c.updateProgress(n.id,25))}),l(7,"25%"),o(),a(8,"button",11),m("click",function(){p(e);let n=s().$implicit,c=s();return g(c.updateProgress(n.id,50))}),l(9,"50%"),o(),a(10,"button",11),m("click",function(){p(e);let n=s().$implicit,c=s();return g(c.updateProgress(n.id,75))}),l(11,"75%"),o(),a(12,"button",11),m("click",function(){p(e);let n=s().$implicit,c=s();return g(c.updateProgress(n.id,100))}),l(13,"Complete!"),o()()()}if(i&2){let e=s().$implicit,t=s();r(2),k("width",e.progress||0,"%"),r(2),b("Progress: ",e.progress||0,"%"),r(2),d("disabled",t.loading),r(2),d("disabled",t.loading),r(2),d("disabled",t.loading),r(2),d("disabled",t.loading)}}function J(i,h){if(i&1){let e=C();a(0,"button",12),m("click",function(){p(e);let n=s().$implicit,c=s();return g(c.join(n.id))}),l(1,"Join"),o()}if(i&2){let e=s(2);d("disabled",e.loading)}}function R(i,h){if(i&1&&(a(0,"div",4)(1,"h3"),l(2),o(),a(3,"p"),l(4),o(),a(5,"p")(6,"strong"),l(7),o(),l(8),o(),v(9,A,14,7,"div",5)(10,J,2,1,"button",6),o()),i&2){let e=h.$implicit;r(2),u(e.title),r(2),u(e.description),r(3),u(e.points),r(),b(" pts \u2022 ",e.duration," days"),r(),d("ngIf",e.joined),r(),d("ngIf",!e.joined)}}var D=(()=>{class i{constructor(e,t){this.svc=e,this.toast=t,this.challenges=[],this.loading=!1}ngOnInit(){this.svc.list().subscribe({next:e=>this.challenges=e.challenges})}join(e){this.loading||(this.loading=!0,this.svc.join(e).subscribe({next:t=>{this.loading=!1,this.toast.show("Successfully joined challenge!","success"),this.challenges=this.challenges.map(n=>n.id===e?_(f({},n),{joined:!0,progress:0}):n)},error:()=>{this.loading=!1,this.toast.show("Failed to join challenge","error")}}))}updateProgress(e,t){this.loading||(this.loading=!0,this.svc.updateProgress(e,t).subscribe({next:()=>{this.loading=!1,this.challenges=this.challenges.map(n=>n.id===e?_(f({},n),{progress:t}):n),t===100?this.toast.show("Challenge completed! Points awarded!","success"):this.toast.show(`Progress updated to ${t}%`,"success")},error:()=>{this.loading=!1,this.toast.show("Failed to update progress","error")}}))}static{this.\u0275fac=function(t){return new(t||i)(x(N),x(O))}}static{this.\u0275cmp=j({type:i,selectors:[["app-challenges-page"]],decls:6,vars:1,consts:[[1,"sf-container"],[1,"sf-card",2,"display","flex","justify-content","space-between","align-items","center"],[1,"grid","grid-2",2,"margin-top","16px"],["class","sf-card",4,"ngFor","ngForOf"],[1,"sf-card"],["class","progress-container",4,"ngIf"],["class","sf-btn",3,"disabled","click",4,"ngIf"],[1,"progress-container"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-controls"],[1,"sf-btn","sf-btn-small",3,"click","disabled"],[1,"sf-btn",3,"click","disabled"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"div",1)(2,"h2"),l(3,"Challenges"),o()(),a(4,"div",2),v(5,R,11,6,"div",3),o()()),t&2&&(r(5),d("ngForOf",n.challenges))},dependencies:[E,M],styles:[".progress-container[_ngcontent-%COMP%]{margin-top:12px}.progress-bar[_ngcontent-%COMP%]{height:8px;background-color:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:8px}.progress-fill[_ngcontent-%COMP%]{height:100%;background-color:#4caf50;transition:width .3s ease}.progress-controls[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}.sf-btn-small[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px}"]})}}return i})();var q=[{path:"",component:D}],X=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=I({type:i})}static{this.\u0275inj=w({imports:[V,T.forChild(q)]})}}return i})();export{X as ChallengesModule};
